<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="2023 X-mas CTF (Alpha Hunter)" />
<meta name="author" content="anonymous" />
<meta property="og:locale" content="en" />
<meta name="description" content="개요" />
<meta property="og:description" content="개요" />
<link rel="canonical" href="http://localhost:4000/posts/Alpha-Hunter/" />
<meta property="og:url" content="http://localhost:4000/posts/Alpha-Hunter/" />
<meta property="og:site_name" content="Web3.0" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-12-25T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="2023 X-mas CTF (Alpha Hunter)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"anonymous"},"dateModified":"2023-12-25T00:00:00+09:00","datePublished":"2023-12-25T00:00:00+09:00","description":"개요","headline":"2023 X-mas CTF (Alpha Hunter)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Alpha-Hunter/"},"url":"http://localhost:4000/posts/Alpha-Hunter/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>2023 X-mas CTF (Alpha Hunter) | Web3.0
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<meta name="apple-mobile-web-app-title" content="Web3.0">
<meta name="application-name" content="Web3.0">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">


  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
  <style>
  hr {
    background:white;
    height:1px;
    border:0;
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
    border: 1px solid var(--color__border-l1);
    border-radius: 4px;
    background-color: var(--color__bg-l1);
    display: flex;
    flex-direction: column;
    padding: 1rem;
    cursor: pointer
}

:root,:root.dark {
    --color__label-red: #ed2360;
    --color__label-yellow: #ffd330;
    --color__label-green: #17a05a;
    --color__label-blue: #2d20e2;
    --color__label-purple: #7549ff;
    --color__label-cyan: #18b4f8;
    --color__text-primary: #e6e6e6;
    --color__text-secondary: #adabb2;
    --color__text-tertiary: #8d8a99;
    --color__text-disabled: #6b6680;
    --color__text-yellow: #ffe878;
    --color__text-destructive: #ff6a8c;
    --color__text-primary-inv: #3f3c4f;
    --color__bg-l0: #1a1825;
    --color__bg-l1: #22202d;
    --color__bg-l2: #2e2b3b;
    --color__bg-l3: #3a3649;
    --color__bg-sidebar: #22202d;
    --color__bg-main: #1a1825;
    --color__bg-hover-l0: #1e1c2b;
    --color__bg-hover-l1: #272432;
    --color__bg-hover-l2: #332f41;
    --color__bg-l0-inv: #fff;
    --color__border-l0: #322f3f;
    --color__border-l1: #322f3f;
    --color__border-l2: #403c4d;
    --color__border-l3: #4f4c5f;
    --color__border-tertiary: rgba(208,204,255,.059);
    --color__overlay: #110f19;
    --font-size__header-xl: 1.625rem;
    --font-size__header-lg: 1.5rem;
    --font-size__header-md: 1.375rem;
    --font-size__header-sm: 1.25rem;
    --font-size__core-copy: 1.125rem;
    --font-size__lg: 1.063rem;
    --font-size__md: 0.938rem;
    --font-size__sm: 0.813rem;
    --color__alert-warning-text: #ebfcff;
    --color__alert-warning-text-secondary: #a1e6ff;
    --color__alert-warning-bg: #052947;
    --color__alert-warning-border: #085f96;
    --color__alert-error-text: #fff0f2;
    --color__alert-error-text-secondary: #ffcbd5;
    --color__alert-error-bg: #650126;
    --color__alert-error-border: #c70948
}
@media(prefers-reduced-motion:no-preference) {
    a {
        transition: color .2s ease-in-out
    }
}
.core-app-profile__bodybottom {
	width:100%;
	order:3;
	display:flex;
	flex-direction:column;
	gap:2rem
}

.profile--audithistory--loadmore {
	text-align:center
}
.profile--audithistory--loadmore hr {
	height:2px;
	background:#7549ff
}
.profile--audithistory--loadmore button {
	color:#fff;
	font-size:16px;
	width:max-content;
	margin:5px auto;
	display:flex;
	flex-direction:row;
	gap:5px;
	justify-content:center;
	align-items:center;
	cursor:pointer
}
.profile--audithistory--loadmore button svg {
	width:16px;
	height:16px
}
.profile--audithistory--loadmore button svg path {
	fill:#7549ff
}
.profile--audithistory--loadmore .audithistory--unavailable {
	margin-top:1rem;
	border:2px solid #2e2b3b;
	border-radius:.25rem;
	padding:1rem
}
.profile--audithistory--loadmore .audithistory--unavailable p {
	font-size:.875rem;
	line-height:1.125rem;
	text-align:start
}
.profile--audithistory--loadmore .audithistory--unavailable p strong {
	color:#fff
}
.profile--audithistory--auditsponsorimg {
	min-width:50px;
	min-height:50px;
	max-width:50px;
	max-height:50px;
	border-radius:50%
}
.profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	left:-15px;
	align-items:flex-end
}
.profile--audithistory--auditheading--date {
	font-size:14px;
	line-height:18px
}
.profile--audithistory--auditheading--title {
	font-size:20px;
	line-height:24px;
	color:#fff
}
.profile--audithistory--monthwrapper {
	margin-top:30px
}
.profile--audithistory--auditwrapper {
	position:relative;
	height:auto;
	margin:10px 0 30px 15px
}
.profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	margin-bottom:25px
}
.profile--audithistory--heading p {
	font-size:18px;
	color:#fff;
	white-space:nowrap
}
.profile--audithistory--heading hr {
	border:1px solid #2e2b3b;
	width:100%;
	height:1px
}
.profile--auditseverity {
	position:relative
}
.profile--auditseverity--lineconnector {
	position:relative;
	left:9px;
	min-height:15px;
	width:.5px;
	background-color:#2e2b3b
}
.profile--auditseverity--lineconnector:last-of-type {
	position:absolute;
	bottom:0
}
.profile--auditseverity--ring {
	width:25px;
	height:25px;
	border-radius:50%;
	display:flex;
	align-items:center;
	justify-content:center;
	position:relative;
	left:-3px
}
.profile--auditseverity--ring--inner {
	border-radius:50%;
	width:5px;
	height:5px;
	background:#fff
}
.profile--auditseverity--severity {
	position:relative;
	display:flex;
	margin-left:45px;
	top:-24px
}
.profile--auditseverity--severity--heading {
	color:var(--color__text-primary)
}
.profile--auditseverity--severity--content {
	margin-left:8px
}
.profile--auditseverity--severity--content--flexwrapper {
	display:flex;
	column-gap:8px;
	row-gap:5px;
	align-items:center;
	flex-wrap:wrap;
	margin-bottom:5px
}
.profile--auditseverity--severity--decorator {
	min-width:4px;
	max-width:4px;
	height:auto
}
.profile--auditseverity--severity--locked {
	font-size:12px;
	display:flex;
	gap:5px;
	flex-direction:row;
	justify-content:flex-start;
	align-items:center
}
.profile--auditseverity--severity--title {
	color:#fff;
	font-weight:semibold;
	overflow-wrap:anywhere
}
.core-app-profile--audithistory--monthwrapper {
	margin-top:40px;
	display:flex;
	flex-direction:column;
	gap:1rem
}
.core-app-profile--audithistory--monthwrapper:first-child {
	margin-top:0
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditwrapper {
	border: 1px solid #beb3c5;
	border-radius:4px;
	background-color:var(--color__bg-l1);
	display:flex;
	flex-direction:column;
	padding:1rem;
	cursor:pointer
}
.core-app-profile--audithistory--heading {
	display:flex;
	flex-direction:row;
	gap:10px;
	align-items:center;
	justify-content:space-between;
	font-size:var(--font-size__header-md);
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--auditheading {
	position:relative;
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center;
	justify-content:space-between
}
.core-app-profile--audithistory--content-wrapper {
	
	flex:1 1;
	position:relative;
	display:flex;
	flex-direction:column;
	gap:14px
}
@media(min-width:450px) {
	.core-app-profile--audithistory--content-wrapper {
		flex-direction:row;
		align-items:center;
		justify-content:space-between
	}
}
.core-app-profile--audithistory--header-wrapper {
	display:flex;
	flex-direction:row;
	gap:14px;
	align-items:center
}
.core-app-profile--audithistory--title {
	font-size:20px;
	line-height:24px;
	font-weight:700;
	color:var(--color__text-primary)
}
.core-app-profile--audithistory--date {
  text-overflow:ellipsis
	white-space:nowrap
}
.core-app-profile--audithistory--wrapper {
	display:flex;
	flex-direction:column-reverse;
	height:100%
}
  </style>

  <!-- A placeholder to allow defining custom metadata -->

  <script src="https://code4rena.com/_next/static/chunks/app/%5B@username%5D/page-20c23029062acd7f.js"></script>
</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/ant.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Web3.0</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Decentralize my life <br>(EVM, CVM)</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/audits/" class="nav-link">
            <i class="fa-fw fas fa-ethereum"></i>
            

            <span>AUDITS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://x.com/l0ptus"
          aria-label="x"
          

          

          

          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="https://etherscan.io/address/0xc39777E85d97a0B5655C62C6378F00D494feAce1"
          aria-label="wallet"
          

          

          

          
        >
          <i class="fab fa-ethereum"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    style="background-color:#030014"
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>2023 X-mas CTF (Alpha Hunter)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>2023 X-mas CTF (Alpha Hunter)</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1703430000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Dec 25, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                anonymous
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3024 words"
>
  <em>16 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <h2 id="개요"><span class="me-2">개요</span><a href="#개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>Description
알파벳을 모아 MERRY CHRISTMAS를 완성해 주세요!!

[RPC Usage]
RPC: http://host:port/rpc
GET FLAG: curl -X GET http://host:port/flag

[Account Information]
address: 0x377CFaD82A885Ef59C9243f715F33752804B1126
private key: 0xdba103874bd715cb05989d00d55f53743dbca7c13c77b2b901c4b6ae90232b5e
balance: 1 ETH

[Contract Information]
Setup address: 0x3e8C8ec7F7a5A51a7B4509d2f4d534BB3bA040b1
</pre></td></tr></tbody></table></code></div></div>
<p>문제를 풀기 위해 제공된 정보는 위와 같다. 컨트랙트는 총 3개가 있는데 Setup 컨트랙트 주소만 제공됐다. (1이더가 제공됨)</p>

<div class="language-zsh highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nb">.</span>
├── House.sol
├── Setup.sol
├── Store.sol
</pre></td></tr></tbody></table></code></div></div>
<p>제공된 파일은 House, Setup, Store로 총 3개가 제공되었다.</p>

<hr />
<h2 id="setupsol"><span class="me-2">Setup.sol</span><a href="#setupsol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>pragma solidity ^0.8.0;

import "./Store.sol";
import "./House.sol";

contract Setup {
    Store public immutable store;
    House public immutable house;
    bool public isStarted;

    constructor() payable {
        store = new Store();
        house = new House();
    }

    function isSolved() external view returns (bool) {
        return 
        store.totalBalances(address(house), "A") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "C") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "E") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "H") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "I") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "M") &gt;= 2
        &amp;&amp; store.totalBalances(address(house), "R") &gt;= 3
        &amp;&amp; store.totalBalances(address(house), "S") &gt;= 2
        &amp;&amp; store.totalBalances(address(house), "T") &gt;= 1
        &amp;&amp; store.totalBalances(address(house), "Y") &gt;= 1;
    }
}
</pre></td></tr></tbody></table></code></div></div>
<p>Setup.sol 파일은 위와 같다. Setup에서 Store, House 컨트랙트를 생성하기 때문에 제공된 Setupt Addr을 통해서 각 컨트랙트의 주소를 가져올 수 있다. 그리고 문제를 해결하기 위한 조건은 house 컨트랙트가 <code class="language-plaintext highlighter-rouge">MERRY CHRISTMAS</code>라는 문자열을 가지고 있게 하면 풀린다. 해당 문자들은 Store 컨트랙트에서 구매가 가능하고, 이를 타 사용자에게 보낼 수 있다.</p>

<hr />
<h2 id="housesol"><span class="me-2">House.sol</span><a href="#housesol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>pragma solidity ^0.8.0;

contract House {
}
</pre></td></tr></tbody></table></code></div></div>
<p>House 컨트랙트는 코드가 없다. 그냥 주소를 위한 컨트랙트이다.</p>

<hr />
<h2 id="storesol"><span class="me-2">Store.sol</span><a href="#storesol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
</pre></td><td class="rouge-code"><pre>pragma solidity ^0.8.0;

contract Store {

    struct DiscountInfo {
        uint256 blockNumber;
        uint[] discountedItems;
        uint[] discountedPrices;
        bytes32 discountCoupon;
    }

    struct Buy {
        uint256[] ids;
        uint256[] prices;
        uint256[] amounts;
    }

    uint256 public constant REGULAR_PRICE = 0.1 ether;
    uint256 public constant PER_N_ITEM = 5;
    bytes public constant  ALPHABETS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    // blockNumber -&gt; discountInfo
    mapping (uint256 =&gt; DiscountInfo) public discountInfos;
    // coupon -&gt; bool
    mapping (bytes32 =&gt; bool) public used; 
    // nonce -&gt; bool
    mapping(uint256 =&gt; bool) public nonces;
    // owner =&gt; alphabet =&gt; amount
    mapping(address =&gt; mapping(bytes1 =&gt; uint256)) public totalBalances;

    error InvalidRange();
    error AlreadyUsed();
    error NotIssued();
    error NotMatched();
    error LowLevelFailed();

    constructor() {
    }

    // [_lowerBound, _upperBound]
    function randRangeWithNonce(uint256 _blockNumber, uint256 _lowerBound, uint256 _upperBound, uint256 _nonce) internal returns (uint256) {
        if (_lowerBound &gt; _upperBound) revert InvalidRange();
        if (nonces[_nonce]) revert AlreadyUsed();
        nonces[_nonce] = true;
        bytes memory _seeds = (abi.encode(msg.sender, _blockNumber, _lowerBound + _upperBound, _nonce));
        return (uint256(keccak256(_seeds)) % (_upperBound - _lowerBound + 1)) + _lowerBound;
    }

    // allow duplicates
    function randSample(uint256 _blockNumber, uint256[] memory _nonces) internal returns (uint[] memory) {
        uint len = PER_N_ITEM;
        uint[] memory _samples = new uint[](len); 
        for(uint i = 0; i &lt; len; i++) {
            _samples[i] = randRangeWithNonce(_blockNumber, uint8(ALPHABETS[0]), uint8(ALPHABETS[0]) + ALPHABETS.length - 1, _nonces[i]);
        }
        return _samples;
    }

    function getDiscountInfo(uint256 blockNumber) public view returns(uint[] memory, uint[] memory, bytes32) {
        return (discountInfos[blockNumber].discountedItems, discountInfos[blockNumber].discountedPrices, discountInfos[blockNumber].discountCoupon);
    }
    
    function issueDiscountCoupon(uint256 _blockNumber, uint256[] memory _nonce) public returns(uint, uint256[] memory, uint256[] memory, bytes32) {

        DiscountInfo storage _discountInfo = discountInfos[_blockNumber];

        uint256[] memory _prices = new uint256[](PER_N_ITEM);
        uint256[] memory _ids = randSample(_blockNumber, _nonce);

        for(uint256 i = 0; i &lt; PER_N_ITEM; i++) {
            uint256 _price = randRangeWithNonce(_blockNumber, 0.0714285714285 ether, 0.09 ether, _nonce[PER_N_ITEM+i]);
            _prices[i] = _price;
        }

        bytes memory _input = abi.encodePacked(_blockNumber);

        for(uint256 i = 0; i &lt; PER_N_ITEM; i++) {
            _input = abi.encodePacked(_input, _ids[i]);
        }

        for(uint256 id = 0; id &lt; PER_N_ITEM; id++) {
            _input = abi.encodePacked(_input, _prices[id]);
        }

        bytes32 hash = keccak256(_input);

        _discountInfo.blockNumber = _blockNumber;
        _discountInfo.discountedItems = _ids;
        _discountInfo.discountedPrices = _prices;
        _discountInfo.discountCoupon = hash;

        return (_blockNumber, _ids, _prices, hash);
    }

    function buyWithCoupon(bytes32 _coupon, uint256[] memory _ids, uint256[] memory _prices, uint256[] memory _amounts) public payable {
        if (discountInfos[block.number].discountCoupon != _coupon || discountInfos[block.number].discountCoupon == 0) revert NotIssued();
        if (used[_coupon]) revert AlreadyUsed();
        bytes memory _input = abi.encodePacked(block.number);

        for(uint256 i = 0; i &lt; _ids.length; i++) {
            _input = abi.encodePacked(_input, _ids[i]);
        }

        for(uint256 i = 0; i &lt; _prices.length; i++) {
            _input = abi.encodePacked(_input, _prices[i]);
        }

        bytes32 _hash = keccak256(_input);
        if (_hash != _coupon) revert NotMatched();
        used[_coupon] = true;

        uint256 _totalAmount = 0;
        for(uint256 i = 0; i &lt; _ids.length; i++) {
            uint256 _amount = _amounts[i];
            _totalAmount += _prices[i] * _amount;
            totalBalances[msg.sender][bytes1(uint8(_ids[i]))] += _amount;
        }

        require(_totalAmount &lt;= msg.value);

        uint256 left = (msg.value - _totalAmount);
        if (left &gt; 0) {
            (bool success, bytes memory data) = msg.sender.call{value: left}("");
            if(!success) revert LowLevelFailed();
        }

    }

    function buy(uint256[] memory _ids, uint256[] memory _amounts) public payable {

        uint256 _totalAmount = 0;
        for(uint256 i = 0; i &lt; _ids.length; i++) {
            uint256 _amount = _amounts[i];
            _totalAmount += REGULAR_PRICE * _amount;
            totalBalances[msg.sender][bytes1(uint8(_ids[i]))] += _amount;
        }

        require(_totalAmount &lt;= msg.value);

        uint256 left = (msg.value - _totalAmount);
        if (left &gt; 0) {
            (bool success, bytes memory data) = msg.sender.call{value: left}("");
            if(!success) revert LowLevelFailed();
        }
    }

    function resell(uint256 _id, uint256 _amount) public {
        if (totalBalances[msg.sender][bytes1(uint8(_id))] &lt; _amount) _amount = totalBalances[msg.sender][bytes1(uint8(_id))];
        totalBalances[msg.sender][bytes1(uint8(_id))] -= _amount;
        uint256 _amt = _amount * REGULAR_PRICE / 2;
        (bool success, bytes memory data) = msg.sender.call{value: _amt}("");
        if(!success) revert LowLevelFailed();
    }

    function give(uint256 _id, uint256 _amount, address _to) public {       
        if (totalBalances[msg.sender][bytes1(uint8(_id))] &lt; _amount) _amount = totalBalances[msg.sender][bytes1(uint8(_id))];
        totalBalances[msg.sender][bytes1(uint8(_id))] -= _amount;
        totalBalances[_to][bytes1(uint8(_id))] += _amount;
    }

    receive() payable external {}
}
</pre></td></tr></tbody></table></code></div></div>
<p>Store.sol의 코드는 위와 같다. 함수가 몇 개 없어서 로직 분석은 빠르게 할 수 있다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>    struct DiscountInfo {
        uint256 blockNumber;
        uint[] discountedItems;
        uint[] discountedPrices;
        bytes32 discountCoupon;
    }

    struct Buy {
        uint256[] ids;
        uint256[] prices;
        uint256[] amounts;
    }

    uint256 public constant REGULAR_PRICE = 0.1 ether;
    uint256 public constant PER_N_ITEM = 5;
    bytes public constant  ALPHABETS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    // blockNumber -&gt; discountInfo
    mapping (uint256 =&gt; DiscountInfo) public discountInfos;
    // coupon -&gt; bool
    mapping (bytes32 =&gt; bool) public used; 
    // nonce -&gt; bool
    mapping(uint256 =&gt; bool) public nonces;
    // owner =&gt; alphabet =&gt; amount
    mapping(address =&gt; mapping(bytes1 =&gt; uint256)) public totalBalances;
</pre></td></tr></tbody></table></code></div></div>
<p>문제에서 사용될 변수들은 위와 같이 정의되어 있다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>   function buyWithCoupon(bytes32 _coupon, uint256[] memory _ids, uint256[] memory _prices, uint256[] memory _amounts) public payable {
        if (discountInfos[block.number].discountCoupon != _coupon || discountInfos[block.number].discountCoupon == 0) revert NotIssued();
        if (used[_coupon]) revert AlreadyUsed();
        bytes memory _input = abi.encodePacked(block.number);

        for(uint256 i = 0; i &lt; _ids.length; i++) {
            _input = abi.encodePacked(_input, _ids[i]);
        }

        for(uint256 i = 0; i &lt; _prices.length; i++) {
            _input = abi.encodePacked(_input, _prices[i]);
        }

        bytes32 _hash = keccak256(_input);
        if (_hash != _coupon) revert NotMatched();
        used[_coupon] = true;

        uint256 _totalAmount = 0;
        for(uint256 i = 0; i &lt; _ids.length; i++) {
            uint256 _amount = _amounts[i];
            _totalAmount += _prices[i] * _amount;
            totalBalances[msg.sender][bytes1(uint8(_ids[i]))] += _amount;
        }

        require(_totalAmount &lt;= msg.value);

        uint256 left = (msg.value - _totalAmount);
        if (left &gt; 0) {
            (bool success, bytes memory data) = msg.sender.call{value: left}("");
            if(!success) revert LowLevelFailed();
        }

    }
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">buyWithCoupon()</code> 함수는 생성된 쿠폰을 이용해서 문자를 구매하는 함수이다. <code class="language-plaintext highlighter-rouge">issueDiscountCoupon()</code> 함수에서 생성된 쿠폰을 기반으로 원하는 수량만큼 구매한다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>    function buy(uint256[] memory _ids, uint256[] memory _amounts) public payable {

        uint256 _totalAmount = 0;
        for(uint256 i = 0; i &lt; _ids.length; i++) {
            uint256 _amount = _amounts[i];
            _totalAmount += REGULAR_PRICE * _amount;
            totalBalances[msg.sender][bytes1(uint8(_ids[i]))] += _amount;
        }

        require(_totalAmount &lt;= msg.value);

        uint256 left = (msg.value - _totalAmount);
        if (left &gt; 0) {
            (bool success, bytes memory data) = msg.sender.call{value: left}("");
            if(!success) revert LowLevelFailed();
        }
    }
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">buy()</code> 함수는 위와 같다. 우리가 원하는 알파벳을 살 수 있다. 코드를 보면 알파벳 하나당 0.1 ether에 구매할 수 있는 것을 확인할 수 있다. 그러나 우리가 구매해야하는 총 문자 개수는 MERRY CHRISTMAS로 14개이다. 현재 우리에게 제공된 잔액은 1 ether인데 <code class="language-plaintext highlighter-rouge">buy()</code> 함수를 이용해서 모든 알파벳을 구매하려면 1.4 ehter + gas가 필요하기 때문에 구매를 할 수 없다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>    function give(uint256 _id, uint256 _amount, address _to) public {       
        if (totalBalances[msg.sender][bytes1(uint8(_id))] &lt; _amount) _amount = totalBalances[msg.sender][bytes1(uint8(_id))];
        totalBalances[msg.sender][bytes1(uint8(_id))] -= _amount;
        totalBalances[_to][bytes1(uint8(_id))] += _amount;
    }
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">give()</code> 함수는 위와 같다. 우리가 구매한 알바벳을 타 주소로 전달할 수 있다. 즉, 우리는 MERRY CHRISTMAS에 포함되어 있는 모든 문자를 구매 후에 <code class="language-plaintext highlighter-rouge">give()</code> 함수를 통해서 house 컨트랙트 주소로 넘기면 된다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>function issueDiscountCoupon(uint256 _blockNumber, uint256[] memory _nonce) public returns(uint, uint256[] memory, uint256[] memory, bytes32) {

        DiscountInfo storage _discountInfo = discountInfos[_blockNumber];

        uint256[] memory _prices = new uint256[](PER_N_ITEM);
        uint256[] memory _ids = randSample(_blockNumber, _nonce);

        for(uint256 i = 0; i &lt; PER_N_ITEM; i++) {
            uint256 _price = randRangeWithNonce(_blockNumber, 0.0714285714285 ether, 0.09 ether, _nonce[PER_N_ITEM+i]);
            _prices[i] = _price;
        }

        bytes memory _input = abi.encodePacked(_blockNumber);

        for(uint256 i = 0; i &lt; PER_N_ITEM; i++) {
            _input = abi.encodePacked(_input, _ids[i]);
        }

        for(uint256 id = 0; id &lt; PER_N_ITEM; id++) {
            _input = abi.encodePacked(_input, _prices[id]);
        }

        bytes32 hash = keccak256(_input);

        _discountInfo.blockNumber = _blockNumber;
        _discountInfo.discountedItems = _ids;
        _discountInfo.discountedPrices = _prices;
        _discountInfo.discountCoupon = hash;

        return (_blockNumber, _ids, _prices, hash);
    }
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">issueDiscountCoupon()</code> 함수는 전달받은 블록 번호와 nonce 값을 기반으로 쿠폰을 생성한다. 이 쿠폰이 생성될 때 할일을 받을 알파벳과 할인율은 nonce 값과 블록 번호에 의해서 생성된다. 쿠폰 번호는 nonce와 블록 번호를 이용해서 구한 _ids + _prices를 모두 바이트 변환하여 더한 값을 해시로 생성한다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>    function randSample(uint256 _blockNumber, uint256[] memory _nonces) internal returns (uint[] memory) {
        uint len = PER_N_ITEM;
        uint[] memory _samples = new uint[](len); 
        for(uint i = 0; i &lt; len; i++) {
            _samples[i] = randRangeWithNonce(_blockNumber, uint8(ALPHABETS[0]), uint8(ALPHABETS[0]) + ALPHABETS.length - 1, _nonces[i]);
        }
        return _samples;
    }
</pre></td></tr></tbody></table></code></div></div>
<p>할인을 받을 알파벳은 <code class="language-plaintext highlighter-rouge">randSample()</code> 함수로 생성된다. <code class="language-plaintext highlighter-rouge">randSample()</code> 함수 내부를 보면 <code class="language-plaintext highlighter-rouge">ransRangeWithNonce()</code> 함수로 ids 값을 만드는데 보면 nonce 값을 기반으로 알바벳을 구하고 있다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>randRangeWithNonce(_blockNumber, 0.0714285714285 ether, 0.09 ether, _nonce[PER_N_ITEM+i]);
</pre></td></tr></tbody></table></code></div></div>
<p>할인율을 구하는 로직은 <code class="language-plaintext highlighter-rouge">randRangeWithNonce()</code> 함수를 위와 같이 호출한다. 위 함수 호출을 통해서 생성될 수 있는 할인 금액의 범위는 0.07 ~ 0.09 ehter이다. 만약 운 좋게 모든 알바벳의 할인 금액이 최저 금액으로 설정 된다고 하더라도 0714285714285 * 14로 0.9999999999989999 ether이다.</p>

<p>구매를 해야하는 총 알바벳은 14개이고, <code class="language-plaintext highlighter-rouge">buyWithCoupon()</code> 함수에 의해서 구매되는 알바벳은 5개이다. (쿠폰 생성 시에 5개를 생성하기 때문에) 즉, 요청을 3번 나누어서 5, 5, (4 + 1)로 1번, 2번 호출에서는 필요한 알파벳 10개를 구매하도록 하고, 3번째 호출에서 4개는 우리가 필요한 알파벳 마지막 1개는 아무 알파벳을 사도록 한다면 총 15개의 쿠폰을 사는 것이기에 잔액 부족으로 트랜잭션이 거부될 것이다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>   function buyWithCoupon(bytes32 _coupon, uint256[] memory _ids, uint256[] memory _prices, uint256[] memory _amounts) public payable {
        if (discountInfos[block.number].discountCoupon != _coupon || discountInfos[block.number].discountCoupon == 0) revert NotIssued();
        if (used[_coupon]) revert AlreadyUsed();
        bytes memory _input = abi.encodePacked(block.number);

        for(uint256 i = 0; i &lt; _ids.length; i++) {
            _input = abi.encodePacked(_input, _ids[i]);
        }

        for(uint256 i = 0; i &lt; _prices.length; i++) {
            _input = abi.encodePacked(_input, _prices[i]);
        }

        bytes32 _hash = keccak256(_input);
        if (_hash != _coupon) revert NotMatched();
        used[_coupon] = true;

        uint256 _totalAmount = 0;
        for(uint256 i = 0; i &lt; _ids.length; i++) {
            uint256 _amount = _amounts[i];
            _totalAmount += _prices[i] * _amount;
            totalBalances[msg.sender][bytes1(uint8(_ids[i]))] += _amount;
        }

        require(_totalAmount &lt;= msg.value);

        uint256 left = (msg.value - _totalAmount);
        if (left &gt; 0) {
            (bool success, bytes memory data) = msg.sender.call{value: left}("");
            if(!success) revert LowLevelFailed();
        }

    }
</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">buyWithCoupon()</code> 함수를 다시 보자. 컨트랙트 내에 저장되어 있는 쿠폰 번호와 현재 블록 번호와 전달받은 _ids, _prices 값을 기반으로 생성된 쿠폰 값을 비교하여 일치하는지 확인하고 있다. 그러나 이 함수 내에서 _ids, _prices 값에 대해서 길이 검증이 존재하지 않는다. 쿠폰 생성 시에는 _ids, _prices가 각 각 5개로 고정이다.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>_ids = [1, 1, 1, 1, 1]
_prices = [1, 1, 1, 1, 1]

_ids = [1, 1]
_prices = [1, 1, 1, 1, 1, 1, 1, 1]
</pre></td></tr></tbody></table></code></div></div>
<p>먼저 알아야 할 내용은 첫 번째 값과 두 번째 값의 해시 값은 동일하다는 것이다. 이유는 쿠폰을 생성할 때, 각 값을 단순하게 이전 바이트 값에 현재 바이트 값을 더해서 해시화하기 때문이다. 이를 이용하면 구매할 때 꼭 5개의 알파벳을 사지 않고, 우리가 원하는 개수만큼 알파벳을 구매할 수 있다. _ids에서 사지 않을 알파벳은 _prices로 옮기면 된다.</p>

<blockquote>
  <p>공격 시나리오</p>
</blockquote>

<ol>
  <li><code class="language-plaintext highlighter-rouge">randRangeWithNonce()</code> 함수를 통해서 우리가 구해야 하는 알파벳들과 일치하는 Nonce 값을 찾는다.</li>
  <li>Step-1에서 찾은 Nonce 값을 2개 또는 3개로 쿠폰을 생성한다.</li>
  <li>생성한 쿠폰으로 알바펫을 사고(2개 또는 3~4개), 이를 <code class="language-plaintext highlighter-rouge">give()</code> 함수로 house로 보낸다.</li>
</ol>

<hr />

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=2023%20X-mas%20CTF%20(Alpha%20Hunter)%20-%20Web3.0&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAlpha-Hunter%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=2023%20X-mas%20CTF%20(Alpha%20Hunter)%20-%20Web3.0&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAlpha-Hunter%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FAlpha-Hunter%2F&text=2023%20X-mas%20CTF%20(Alpha%20Hunter)%20-%20Web3.0" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->


















            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/BMW-CTF/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1704207600"
  data-df="ll"
  
>
  Jan  3, 2024
</time>

              <h4 class="pt-0 my-2">BMW Web3 CTF</h4>
              <div class="text-muted">
                <p>
                  





                  개요


  Introduction
안녕하세요. BMW는 Break My Wall의 약자로 나의 벽을 깨부순다는 의미입니다. 나의 한계를 극복함과 동시에 우리가 WEB3 생태계의 진입장벽을 부수자는 의미를 함축하고 있습니다. BMW는 KITRI 차세대 보안리더 양성 프로그램 WHS 1기 프로젝트팀이며, WEB3의 취약점을 연구하고 워게임 사이트를 제작...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/RealWorld-CTF-6th/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1706454000"
  data-df="ll"
  
>
  Jan 29, 2024
</time>

              <h4 class="pt-0 my-2">Real World CTF 6th (SafeBridge)</h4>
              <div class="text-muted">
                <p>
                  





                  개요

Real World CTF에 웹3 문제 있길래 풀어봤다. SafeBridge 문제의 솔브 조건은 L1 -&amp;gt; L2 브리지에서 토큰 잔액을 빼내는 것이었다. 이더리움에서 L1 -&amp;gt; L2 브리지는 주로 두 가지 계층 간의 상호 작용을 용이하게 하는 기술을 가리킨다.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
cont...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ERC1337-DH/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1712415600"
  data-df="ll"
  
>
  Apr  7, 2024
</time>

              <h4 class="pt-0 my-2">Dreamhack CTF (ERC1337)</h4>
              <div class="text-muted">
                <p>
                  





                  개요

ERC1337 문제는 Third Contract 분석을 통해서 에 구조를 파악하여 취약점을 악용하여 Owner가 가지고 있는 토큰을 탈취하는 문제이다.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
contract Level {
    ERC1337 public token;
    uint256 public solved;
    ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Enzyme-Finance-Vuln/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Dive into the real world: 0x01</p>
    </a>
  

  
    <a
      href="/posts/BMW-CTF/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>BMW Web3 CTF</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
style="background-color:#030014"
>

</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

